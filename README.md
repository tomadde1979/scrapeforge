# Full-Stack Vite + Express App

A complete full-stack JavaScript application with **React (via Vite)** frontend and **Express.js** backend, structured for Heroku deployment.

## ğŸ“ Project Structure

```
/
â”œâ”€â”€ package-heroku.json   # Root package.json with heroku-postbuild script
â”œâ”€â”€ server/
â”‚   â””â”€â”€ index.cjs        # Express server listening on process.env.PORT || 8080
â”œâ”€â”€ client/              # React app created with `npm create vite@latest`
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ App.jsx     # React component with backend integration
â”‚   â”‚   â”œâ”€â”€ App.css     # Styled components
â”‚   â”‚   â””â”€â”€ main.jsx    # React entry point
â”‚   â”œâ”€â”€ dist/           # Built frontend files (generated by build)
â”‚   â”œâ”€â”€ package.json    # Client dependencies
â”‚   â””â”€â”€ vite.config.js  # Vite config with proxy
â””â”€â”€ README.md           # This file
```

## âœ¨ Key Features

- **Express Backend**: API endpoints and serves built React app from `client/dist/`
- **React Frontend**: Modern Vite-powered React app with backend integration
- **Heroku Ready**: `heroku-postbuild` script builds frontend automatically
- **SPA Support**: Express serves `index.html` for all unknown routes
- **Development**: Vite dev server with API proxy to Express backend

## ğŸš€ Scripts (in root package.json)

```json
{
  "scripts": {
    "heroku-postbuild": "cd client && npm install && npm run build",
    "start": "node server/index.cjs"
  }
}
```

## ğŸ”— API Endpoints

| Method | Endpoint | Description |
|--------|----------|-------------|
| `GET`  | `/api/health` | Server health check with environment info |
| `GET`  | `/api/test` | Test endpoint for backend connection |
| `GET`  | `/*` | Serves React app (SPA fallback) |

## ğŸ› ï¸ Development

```bash
# Install root dependencies
npm install

# Install client dependencies
cd client && npm install && cd ..

# Start development servers (manually)
# Terminal 1: Backend  
node server/index.cjs

# Terminal 2: Frontend
cd client && npm run dev
```

## ğŸ—ï¸ Build Process

The `heroku-postbuild` script runs automatically on deployment:

1. `cd client` - Navigate to client directory
2. `npm install` - Install client dependencies
3. `npm run build` - Build React app to `client/dist/`
4. Express serves static files from `client/dist/`
5. Fallback route serves `index.html` for SPA routing

## ğŸ“¦ Production Deployment

### Express Server Configuration

```javascript
// Serve static files from client/dist
app.use(express.static(path.join(__dirname, '../client/dist')));

// Handle React routing - serve index.html for all non-API routes
app.get('*', (req, res) => {
  res.sendFile(path.join(__dirname, '../client/dist/index.html'));
});
```

### Vite Configuration

```javascript
// client/vite.config.js
export default defineConfig({
  plugins: [react()],
  server: {
    proxy: {
      '/api': {
        target: 'http://localhost:8080',
        changeOrigin: true,
      },
    },
  },
  build: {
    outDir: 'dist',
  },
})
```

## ğŸ§ª Testing

### Local Testing

```bash
# Build the frontend
cd client && npm run build && cd ..

# Start production server
NODE_ENV=production PORT=8080 node server/index.cjs

# Test endpoints
curl http://localhost:8080/api/health
curl http://localhost:8080/api/test
curl http://localhost:8080/  # Should serve React app
```

### Production Testing

After deployment:

```bash
curl https://your-app.herokuapp.com/api/health
```

Expected response:
```json
{
  "status": "OK",
  "timestamp": "2025-01-28T...",
  "environment": "production",
  "port": "8080"
}
```

## ğŸ¯ Architecture Compliance

âœ… **Root package.json** - Contains `heroku-postbuild` script  
âœ… **Frontend in `/client`** - Created with `npm create vite@latest`  
âœ… **Backend in `/server`** - Express.js listening on `process.env.PORT || 8080`  
âœ… **Static Serving** - Express serves `client/dist/`  
âœ… **SPA Fallback** - Unknown routes serve `index.html`  
âœ… **Build Integration** - `heroku-postbuild` handles frontend build  

## ğŸŒ Live Application

After deployment:
- **App**: `https://your-app.herokuapp.com`
- **Health**: `https://your-app.herokuapp.com/api/health`
- **Test**: `https://your-app.herokuapp.com/api/test`

The Express server serves the built Vite files and handles React routing seamlessly!